
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Erfan Zare Chavoshi">
      
      
      
        <link rel="prev" href="../generated-serve-serve_engine-dantics/">
      
      
        <link rel="next" href="../generated-serve-torch_serve/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Serve - EasyDel</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#serveserve_engineserve" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="EasyDel" class="md-header__button md-logo" aria-label="EasyDel" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EasyDel
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Serve
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/erfanzar/EasyDel" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="EasyDel" class="md-nav__button md-logo" aria-label="EasyDel" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EasyDel
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/erfanzar/EasyDel" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    APIs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Preprocessing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Data Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-data_preprocessing-_processor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Etils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Etils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-auto_tx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto Tx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-configs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-easystate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easystate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-etils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Etils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Eval
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Eval
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-eval-lm_eval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lm Eval
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linen
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Linen
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-linen-bits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-linen-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-auto_easydel_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto Easydel Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_2" id="__nav_1_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cohere
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_2">
            <span class="md-nav__icon md-icon"></span>
            Cohere
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-cohere-cohere_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cohere Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-cohere-modelling_cohere_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Cohere Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_3" id="__nav_1_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dbrx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_3">
            <span class="md-nav__icon md-icon"></span>
            Dbrx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-dbrx-dbrx_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dbrx Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-dbrx-modelling_dbrx_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Dbrx Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-easy_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easy Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-easydel_modelling_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easydel Modelling Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6" id="__nav_1_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Falcon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6">
            <span class="md-nav__icon md-icon"></span>
            Falcon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-falcon-falcon_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-falcon-modelling_falcon_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Falcon Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-flax_modelling_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flax Modelling Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8" id="__nav_1_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gemma
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8">
            <span class="md-nav__icon md-icon"></span>
            Gemma
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gemma-gemma_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gemma Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gemma-modelling_gemma_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gemma Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_9" >
        
          
          <label class="md-nav__link" for="__nav_1_5_9" id="__nav_1_5_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpt J
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_9">
            <span class="md-nav__icon md-icon"></span>
            Gpt J
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_j-gpt_j_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gpt J Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_j-modelling_gpt_j_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gpt J Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_10" >
        
          
          <label class="md-nav__link" for="__nav_1_5_10" id="__nav_1_5_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpt Neo X
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_10">
            <span class="md-nav__icon md-icon"></span>
            Gpt Neo X
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_neo_x-gpt_neo_x_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gpt Neo X Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_neo_x-modelling_gpt_neo_x_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gpt Neo X Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_11" >
        
          
          <label class="md-nav__link" for="__nav_1_5_11" id="__nav_1_5_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpt2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_11">
            <span class="md-nav__icon md-icon"></span>
            Gpt2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt2-gpt2_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gpt2 Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt2-modelling_gpt2_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gpt2 Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_12" >
        
          
          <label class="md-nav__link" for="__nav_1_5_12" id="__nav_1_5_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grok 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_12">
            <span class="md-nav__icon md-icon"></span>
            Grok 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-grok_1-grok_1_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grok 1 Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-grok_1-modelling_grok_1_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Grok 1 Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_13" >
        
          
          <label class="md-nav__link" for="__nav_1_5_13" id="__nav_1_5_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Jetmoe
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_13">
            <span class="md-nav__icon md-icon"></span>
            Jetmoe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-jetmoe-jetmoe_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jetmoe Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-jetmoe-modelling_jetmoe_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Jetmoe Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_14" >
        
          
          <label class="md-nav__link" for="__nav_1_5_14" id="__nav_1_5_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Llama
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_14">
            <span class="md-nav__icon md-icon"></span>
            Llama
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-llama_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-modelling_llama_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Llama Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-modelling_vision_llama_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Vision Llama Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-vision_llama_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Llama Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_15" >
        
          
          <label class="md-nav__link" for="__nav_1_5_15" id="__nav_1_5_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lucid Transformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_15">
            <span class="md-nav__icon md-icon"></span>
            Lucid Transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-lucid_transformer-lt_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lt Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-lucid_transformer-modelling_lt_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Lt Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_16" >
        
          
          <label class="md-nav__link" for="__nav_1_5_16" id="__nav_1_5_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mamba
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_16">
            <span class="md-nav__icon md-icon"></span>
            Mamba
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mamba-mamba_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mamba Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mamba-modelling_mamba_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mamba Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_17" >
        
          
          <label class="md-nav__link" for="__nav_1_5_17" id="__nav_1_5_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mistral
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_17">
            <span class="md-nav__icon md-icon"></span>
            Mistral
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-mistral_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mistral Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-modelling_mistral_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mistral Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-modelling_vision_mistral_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Vision Mistral Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-vision_mistral_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Mistral Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_18" >
        
          
          <label class="md-nav__link" for="__nav_1_5_18" id="__nav_1_5_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mixtral
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_18">
            <span class="md-nav__icon md-icon"></span>
            Mixtral
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mixtral-mixtral_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixtral Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mixtral-modelling_mixtral_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mixtral Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_19" >
        
          
          <label class="md-nav__link" for="__nav_1_5_19" id="__nav_1_5_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mosaic Mpt
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_19">
            <span class="md-nav__icon md-icon"></span>
            Mosaic Mpt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mosaic_mpt-modelling_mpt_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mpt Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mosaic_mpt-mosaic_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mosaic Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_20" >
        
          
          <label class="md-nav__link" for="__nav_1_5_20" id="__nav_1_5_20_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Olmo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_20">
            <span class="md-nav__icon md-icon"></span>
            Olmo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-olmo-modelling_olmo_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Olmo Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-olmo-olmo_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Olmo Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_21" >
        
          
          <label class="md-nav__link" for="__nav_1_5_21" id="__nav_1_5_21_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Opt
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_21">
            <span class="md-nav__icon md-icon"></span>
            Opt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-opt-modelling_opt_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Opt Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-opt-opt_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Opt Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_22" >
        
          
          <label class="md-nav__link" for="__nav_1_5_22" id="__nav_1_5_22_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Palm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_22">
            <span class="md-nav__icon md-icon"></span>
            Palm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-palm-modelling_palm_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Palm Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-palm-palm_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Palm Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_23" >
        
          
          <label class="md-nav__link" for="__nav_1_5_23" id="__nav_1_5_23_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Phi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_23">
            <span class="md-nav__icon md-icon"></span>
            Phi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-phi-modelling_phi_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Phi Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-phi-phi_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phi Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_24" >
        
          
          <label class="md-nav__link" for="__nav_1_5_24" id="__nav_1_5_24_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Qwen1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_24_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_24">
            <span class="md-nav__icon md-icon"></span>
            Qwen1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen1-modelling_qwen1_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Qwen1 Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen1-qwen1_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qwen1 Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_25" >
        
          
          <label class="md-nav__link" for="__nav_1_5_25" id="__nav_1_5_25_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Qwen2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_25_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_25">
            <span class="md-nav__icon md-icon"></span>
            Qwen2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2-modelling_qwen_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Qwen Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2-qwen_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qwen Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_26" >
        
          
          <label class="md-nav__link" for="__nav_1_5_26" id="__nav_1_5_26_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Qwen2 Moe
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_26_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_26">
            <span class="md-nav__icon md-icon"></span>
            Qwen2 Moe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2_moe-configuration_qwen2_moe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Qwen2 Moe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2_moe-modeling_qwen2_moe_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Qwen2 Moe Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_27" >
        
          
          <label class="md-nav__link" for="__nav_1_5_27" id="__nav_1_5_27_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Roberta
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_27_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_27">
            <span class="md-nav__icon md-icon"></span>
            Roberta
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-roberta-modelling_roberta_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Roberta Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-roberta-roberta_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roberta Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_28" >
        
          
          <label class="md-nav__link" for="__nav_1_5_28" id="__nav_1_5_28_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Rwkv
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_28_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_28">
            <span class="md-nav__icon md-icon"></span>
            Rwkv
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-rwkv-modelling_rwkv_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Rwkv Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-rwkv-rwkv_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rwkv Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_29" >
        
          
          <label class="md-nav__link" for="__nav_1_5_29" id="__nav_1_5_29_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stablelm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_29_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_29">
            <span class="md-nav__icon md-icon"></span>
            Stablelm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-stablelm-modelling_stablelm_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Stablelm Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-stablelm-stablelm_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stablelm Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_30" >
        
          
          <label class="md-nav__link" for="__nav_1_5_30" id="__nav_1_5_30_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    T5
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_30_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_30">
            <span class="md-nav__icon md-icon"></span>
            T5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-t5-modelling_t5_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling T5 Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-t5-t5_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    T5 Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_31" >
        
          
          <label class="md-nav__link" for="__nav_1_5_31" id="__nav_1_5_31_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Whisper
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_31_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_31">
            <span class="md-nav__icon md-icon"></span>
            Whisper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-whisper-modelling_whisper_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Whisper Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-whisper-whisper_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whisper Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Partitioning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Partitioning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-partitioning-partitioner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitioner
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            Reinforcement Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_2" >
        
          
          <label class="md-nav__link" for="__nav_1_7_2" id="__nav_1_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-models-modelling_casual_language_rl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Casual Language Rl
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_3" >
        
          
          <label class="md-nav__link" for="__nav_1_7_3" id="__nav_1_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7_3">
            <span class="md-nav__icon md-icon"></span>
            Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-partitioner_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitioner Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-ppo_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ppo Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-ppo_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ppo Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-training_configs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Configs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_4" >
        
          
          <label class="md-nav__link" for="__nav_1_7_4" id="__nav_1_7_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-utils-collectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collectors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" checked>
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Serve
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            Serve
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-gradio_user_interface_base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradio User Interface Base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-jax_serve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jax Serve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_3" >
        
          
          <label class="md-nav__link" for="__nav_1_8_3" id="__nav_1_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Prompters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8_3">
            <span class="md-nav__icon md-icon"></span>
            Prompters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-base_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-cargo_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cargo Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-chatml_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chatml Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-gemma_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gemma Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-guanaco_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guanaco Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-llama2_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama2 Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-openchat_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Openchat Prompter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-prompters-zephyr_prompter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Zephyr Prompter
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_4" checked>
        
          
          <label class="md-nav__link" for="__nav_1_8_4" id="__nav_1_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Serve Engine
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_8_4">
            <span class="md-nav__icon md-icon"></span>
            Serve Engine
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-serve_engine-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-serve_engine-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-serve_engine-dantics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dantics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Serve
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Serve
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve" class="md-nav__link">
    <span class="md-ellipsis">
      serve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe" class="md-nav__link">
    <span class="md-ellipsis">
      EasyServe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EasyServe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.api_generate_request" class="md-nav__link">
    <span class="md-ellipsis">
      api_generate_request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.compile" class="md-nav__link">
    <span class="md-ellipsis">
      compile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.conversation_template" class="md-nav__link">
    <span class="md-ellipsis">
      conversation_template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.create_generation_functions_and_tokenizers" class="md-nav__link">
    <span class="md-ellipsis">
      create_generation_functions_and_tokenizers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.create_shard_and_gather_functions" class="md-nav__link">
    <span class="md-ellipsis">
      create_shard_and_gather_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.from_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      from_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.shard_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      shard_parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-torch_serve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Torch Serve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Smi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            Smi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-smi-smi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Smi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-base_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10_2" >
        
          
          <label class="md-nav__link" for="__nav_1_10_2" id="__nav_1_10_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Causal Language Model Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10_2">
            <span class="md-nav__icon md-icon"></span>
            Causal Language Model Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-causal_language_model_trainer-causal_language_model_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Causal Language Model Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-causal_language_model_trainer-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-causal_language_model_trainer-modeling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Output
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10_3" >
        
          
          <label class="md-nav__link" for="__nav_1_10_3" id="__nav_1_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dpo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10_3">
            <span class="md-nav__icon md-icon"></span>
            Dpo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-dpo_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dpo Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-modelling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10_4" >
        
          
          <label class="md-nav__link" for="__nav_1_10_4" id="__nav_1_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sft
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10_4">
            <span class="md-nav__icon md-icon"></span>
            Sft
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-sft-stf_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stf Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-sft-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-training_configurations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10_7" >
        
          
          <label class="md-nav__link" for="__nav_1_10_7" id="__nav_1_10_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vision Causal Language Model Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_10_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10_7">
            <span class="md-nav__icon md-icon"></span>
            Vision Causal Language Model Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-vision_causal_language_model_trainer-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-vision_causal_language_model_trainer-modelling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-vision_causal_language_model_trainer-vision_causal_language_model_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Causal Language Model Trainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" >
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            Transform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-easydel_transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easydel Transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-falcon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-llama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-mistral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mistral
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-mpt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mpt
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_12" >
        
          
          <label class="md-nav__link" for="__nav_1_12" id="__nav_1_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_12">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-checker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-prompters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-tensor_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensor Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../AvailableModels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AvailableModels
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CONTRIBUTING
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Bits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyBIT
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DataProcessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataProcessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../EasyAttentionExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easy Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../EasyStateExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyState
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Falcon/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FineTuningExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fine Tuning Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../JAXServer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JAXServer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Llama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Llama2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama2 Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LoRA-TransferLearningExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LoRA and Transfer Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mistral/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mistral Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Parameter-Quantization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Parameter Quantization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MosaicMPT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MosaicMPT Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PyTorchServer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PytorchServer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    install
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve" class="md-nav__link">
    <span class="md-ellipsis">
      serve
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe" class="md-nav__link">
    <span class="md-ellipsis">
      EasyServe
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EasyServe">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.api_generate_request" class="md-nav__link">
    <span class="md-ellipsis">
      api_generate_request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.compile" class="md-nav__link">
    <span class="md-ellipsis">
      compile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.conversation_template" class="md-nav__link">
    <span class="md-ellipsis">
      conversation_template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.create_generation_functions_and_tokenizers" class="md-nav__link">
    <span class="md-ellipsis">
      create_generation_functions_and_tokenizers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.create_shard_and_gather_functions" class="md-nav__link">
    <span class="md-ellipsis">
      create_shard_and_gather_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.from_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      from_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lib.python.EasyDel.serve.serve_engine.serve.EasyServe.shard_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      shard_parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="serveserve_engineserve">serve.serve_engine.serve</h1>


<div class="doc doc-object doc-module">



<a id="lib.python.EasyDel.serve.serve_engine.serve"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe" class="doc doc-heading">
          <code>EasyServe</code>


</h2>


  <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EasyServe</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">llm</span><span class="p">:</span> <span class="n">EasyDelFlaxPretrainedModel</span><span class="p">,</span>
            <span class="n">params</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FrozenDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
            <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizerBase</span><span class="p">,</span>
            <span class="n">prefix_tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizerBase</span><span class="p">,</span>
            <span class="n">greedy_generate_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
            <span class="n">non_greedy_generate_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
            <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">llm</span> <span class="o">=</span> <span class="n">llm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span> <span class="o">=</span> <span class="n">tokenizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix_tokenizer</span> <span class="o">=</span> <span class="n">prefix_tokenizer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greedy_generate_function</span> <span class="o">=</span> <span class="n">greedy_generate_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">non_greedy_generate_function</span> <span class="o">=</span> <span class="n">non_greedy_generate_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span> <span class="o">=</span> <span class="n">serve_config</span>
        <span class="k">if</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">pre_compile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">verbose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_api</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;EasyDeL&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fast_api</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/generate/v1/conversation&quot;</span><span class="p">)(</span><span class="bp">self</span><span class="o">.</span><span class="n">api_generate_request</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_generation_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">greedy_generate_function</span> <span class="k">if</span> <span class="n">greedy</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">non_greedy_generate_function</span>

    <span class="k">def</span> <span class="nf">conversation_template</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">conversation</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ConversationItem</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The conversation_template function takes a list of ConversationItem objects and returns a string.</span>
<span class="sd">        The string is formatted as follows:</span>
<span class="sd">            &amp;lt;s&amp;gt;[INST] &amp;lt;&amp;lt;SYS&amp;gt;&amp;gt;{system_message}&amp;lt;&amp;lt;/SYS&amp;gt;&amp;gt;\n\n{user_message} [/INST]</span>
<span class="sd">            {assistant_message} &amp;lt;/s&amp;gt;&amp;lt;s&amp;gt;[INST] ...</span>
<span class="sd">        where system message, user message, and assistant message are the content fields of the ConversationItem objects.</span>
<span class="sd">        If there is no system message in the conversation, then it will be omitted from the template.</span>

<span class="sd">        :param self: Refer to the current instance of a class</span>
<span class="sd">        :param conversation: List[ConversationItem]: Pass in the conversation items</span>
<span class="sd">        :return: A string that is a concatenation of the messages in the conversation</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">system</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">do_strip</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">conversation</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">conv</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;system&quot;</span><span class="p">:</span>
                <span class="n">system</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">content</span>
        <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;&lt;s&gt;[INST] &lt;&lt;SYS&gt;&gt;</span><span class="se">\n</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="se">\n</span><span class="s2">&lt;&lt;/SYS&gt;&gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">system</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&lt;s&gt;[INST] &quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">conversation</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">do_strip</span> <span class="k">else</span> <span class="n">conv</span><span class="o">.</span><span class="n">content</span>
            <span class="n">role</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">role</span>
            <span class="n">do_strip</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span> <span class="ow">or</span> <span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;assistant&quot;</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2"> [/INST] &quot;</span> <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2"> &lt;/s&gt;&lt;s&gt;[INST] &quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">api_generate_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">GenerateAPIRequest</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The api_generate_request function is the main function that will be called by the API.</span>
<span class="sd">        It takes in a GenerateAPIRequest object, which contains all the information needed to generate a response.</span>
<span class="sd">        The request object has two fields: conversation and max_new_tokens. The conversation field is an array of strings,</span>
<span class="sd">        which are each one turn in a conversation (i.e., one person&#39;s utterance). The max_new_tokens field specifies</span>
<span class="sd">         how many tokens can be generated at most for this response.</span>

<span class="sd">        :param self: Access the attributes and methods of the class</span>
<span class="sd">        :param request: GenerateAPIRequest: Pass the request object to the api_generate_request function</span>
<span class="sd">        :return: A dictionary with the following keys {&quot;response&quot;, &quot;num_token_generated&quot;, &quot;greedy&quot;, &quot;model_prompt&quot;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversation_template</span><span class="p">(</span>
            <span class="n">request</span><span class="o">.</span><span class="n">conversation</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">num_token_generated</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">response</span><span class="p">,</span> <span class="n">num_token_generated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">string</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
                <span class="n">max_new_tokens</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">max_new_tokens</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_new_tokens</span><span class="p">,</span>
                <span class="n">greedy</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">greedy</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">greedy</span>
        <span class="p">):</span>
            <span class="o">...</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span>
            <span class="s2">&quot;num_token_generated&quot;</span><span class="p">:</span> <span class="n">num_token_generated</span><span class="p">,</span>
            <span class="s2">&quot;greedy&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">greedy</span><span class="p">,</span>
            <span class="s2">&quot;model_prompt&quot;</span><span class="p">:</span> <span class="n">prompt</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_shard_and_gather_functions</span><span class="p">(</span>
            <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]],</span>
            <span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fp16&quot;</span>
    <span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The create_shard_and_gather_functions function takes in a dictionary of parameters,</span>
<span class="sd">        a tuple of partition rules, and an optional dtype. It then matches the partition rules to the</span>
<span class="sd">        parameters and creates shard functions for each parameter. The shard functions are used to</span>
<span class="sd">        split up a parameter into shards (or partitions) that can be stored on different devices.</span>
<span class="sd">        The gather function is used to combine all the shards back together again.</span>

<span class="sd">        :param parameters: dict: Specify the parameters of the model</span>
<span class="sd">        :param partition_rules: Tuple[Tuple[str,  PartitionSpec]]: Specify which parameters to partition</span>
<span class="sd">        :param dtype: jax.numpy.dtype | str: Specify the data type of the parameters</span>
<span class="sd">        :return: A tuple of three elements:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">partition_specs</span> <span class="o">=</span> <span class="n">match_partition_rules</span><span class="p">(</span><span class="n">partition_rules</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">make_shard_and_gather_fns</span><span class="p">(</span>
            <span class="n">partition_specs</span><span class="o">=</span><span class="n">partition_specs</span><span class="p">,</span>
            <span class="n">dtype_specs</span><span class="o">=</span><span class="n">get_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span><span class="p">,</span> <span class="n">partition_specs</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">shard_parameters</span><span class="p">(</span>
            <span class="n">mesh</span><span class="p">:</span> <span class="n">Mesh</span><span class="p">,</span>
            <span class="n">params</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FrozenDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
            <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]],</span>
            <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
    <span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The shard_parameters function takes a set of parameters and partitions them according to the partition_rules.</span>

<span class="sd">        :param mesh: Mesh: Create a mesh object that is used to shard the parameters</span>
<span class="sd">        :param params: FrozenDict | dict: Pass in the parameters of the model</span>
<span class="sd">        :param partition_rules: Tuple[Tuple[str, PartitionSpec]]: Specify the partitioning rules for each parameter</span>
<span class="sd">        :param serve_config: EasyServeConfig: Specify the dtype of the parameters</span>
<span class="sd">        :param : Create a mesh of devices</span>
<span class="sd">        :return: sharded parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">partition_specs</span> <span class="o">=</span> <span class="n">match_partition_rules</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">)</span>
        <span class="n">shard_fns</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">make_shard_and_gather_fns</span><span class="p">(</span><span class="n">partition_specs</span><span class="p">,</span> <span class="n">get_dtype</span><span class="p">(</span><span class="n">serve_config</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

        <span class="k">with</span> <span class="n">mesh</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">func</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="n">shard_fns</span><span class="p">,</span> <span class="n">params</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_generation_functions_and_tokenizers</span><span class="p">(</span>
            <span class="n">model</span><span class="p">:</span> <span class="n">EasyDelFlaxPretrainedModel</span><span class="p">,</span>
            <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizerBase</span><span class="p">,</span>
            <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
            <span class="n">partition_specs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LLMBaseReq</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The create_generation_functions_and_tokenizers function is used to create the functions that will be used for</span>
<span class="sd">        generation. It also creates a tokenizer object that can be used to encode and decode text. The function takes in</span>
<span class="sd">        a model, a tokenizer, an EasyServeConfig object (which contains all the parameters needed for generation), and</span>
<span class="sd">        partition_specs which are specifications about how data should be partitioned across devices.</span>

<span class="sd">        :param model: EasyDelFlaxPretrainedModel: Create the model and tokenizer</span>
<span class="sd">        :param tokenizer: PreTrainedTokenizerBase: Create a tokenizer object</span>
<span class="sd">        :param serve_config: EasyServeConfig: Create the generation function</span>
<span class="sd">        :param partition_specs: dict[str, PartitionSpec]: Specify the sharding of the model parameters</span>
<span class="sd">        :return: An LLMBaseReq object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Tokenizer does not contain padding token setting padding token to eos token for open end generation&quot;</span><span class="p">)</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
            <span class="n">prefix_tokenizer</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
            <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The class Model of Tokenizer </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span><span class="si">}</span><span class="s2"> do not support deepcopy option &quot;</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">use_prefix_tokenizer</span><span class="p">:</span>
                <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
                <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
                <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
            <span class="n">prefix_tokenizer</span> <span class="o">=</span> <span class="n">tokenizer</span>

        <span class="nd">@functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
            <span class="n">pjit</span><span class="p">,</span>
            <span class="n">in_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">partition_specs</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">(),</span> <span class="n">PartitionSpec</span><span class="p">()),</span>
            <span class="n">out_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">PartitionSpec</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">greedy_generate_function</span><span class="p">(</span>
                <span class="n">parameters</span><span class="p">,</span>
                <span class="n">input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span>
        <span class="p">):</span>
            <span class="n">input_ids</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
            <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
            <span class="n">predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
                <span class="n">input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                <span class="n">generation_config</span><span class="o">=</span><span class="n">GenerationConfig</span><span class="p">(</span>
                    <span class="n">max_new_tokens</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>

                    <span class="n">eos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">,</span>
                    <span class="n">pad_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span><span class="p">,</span>
                    <span class="n">bos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">bos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">,</span>

                    <span class="n">do_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">num_beams</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">sequences</span><span class="p">[:,</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>
            <span class="k">return</span> <span class="n">predict</span>

        <span class="nd">@functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
            <span class="n">pjit</span><span class="p">,</span>
            <span class="n">in_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">partition_specs</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">(),</span> <span class="n">PartitionSpec</span><span class="p">()),</span>
            <span class="n">out_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">PartitionSpec</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">def</span> <span class="nf">non_greedy_generate_function</span><span class="p">(</span>
                <span class="n">parameters</span><span class="p">,</span>
                <span class="n">input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span>
        <span class="p">):</span>
            <span class="n">input_ids</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
            <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
            <span class="n">predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
                <span class="n">input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
                <span class="n">generation_config</span><span class="o">=</span><span class="n">GenerationConfig</span><span class="p">(</span>
                    <span class="n">max_new_tokens</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>

                    <span class="n">eos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">,</span>
                    <span class="n">pad_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span><span class="p">,</span>
                    <span class="n">bos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">bos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">,</span>

                    <span class="n">temperature</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
                    <span class="n">repetition_penalty</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">repetition_penalty</span><span class="p">,</span>
                    <span class="n">do_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">num_beams</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">top_p</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">top_p</span><span class="p">,</span>
                    <span class="n">top_k</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">top_k</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">sequences</span><span class="p">[:,</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>
            <span class="k">return</span> <span class="n">predict</span>

        <span class="k">return</span> <span class="n">LLMBaseReq</span><span class="p">(</span>
            <span class="n">greedy_generate_function</span><span class="o">=</span><span class="n">greedy_generate_function</span><span class="p">,</span>
            <span class="n">non_greedy_generate_function</span><span class="o">=</span><span class="n">non_greedy_generate_function</span><span class="p">,</span>
            <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
            <span class="n">prefix_tokenizer</span><span class="o">=</span><span class="n">prefix_tokenizer</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_parameters</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">llm</span><span class="p">:</span> <span class="n">EasyDelFlaxPretrainedModel</span><span class="p">,</span>
            <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
            <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizerBase</span><span class="p">,</span>
            <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]],</span>
            <span class="n">shard_parameters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The from_parameters function is the main entry point for creating a model that can be served.</span>
<span class="sd">        It takes in a pretrained model, parameters, tokenizer and serve_config as input and returns an object of type</span>
<span class="sd">        EasyServe.</span>

<span class="sd">        :param cls: Create a new instance of the class</span>
<span class="sd">        :param llm: EasyDelFlaxPretrainedModel: Pass the model to the class</span>
<span class="sd">        :param params: dict: Pass the parameters of the model</span>
<span class="sd">        :param tokenizer: PreTrainedTokenizerBase: Create the tokenizer and prefix_tokenizer</span>
<span class="sd">        :param serve_config: EasyServeConfig: Configure the model for serving</span>
<span class="sd">        :param partition_rules: Tuple[Tuple[str, PartitionSpec]]: Partition the parameters of the model</span>
<span class="sd">        :param shard_parameters: bool: Specify whether the parameters should be sharded or not</span>
<span class="sd">        :param : Shard the parameters of the model</span>
<span class="sd">        :return: A EasyServe object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span><span class="p">,</span> <span class="n">partition_specs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_shard_and_gather_functions</span><span class="p">(</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">dtype</span>
        <span class="p">)</span>
        <span class="n">llm_base_req</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_generation_functions_and_tokenizers</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
            <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
            <span class="n">partition_specs</span><span class="o">=</span><span class="n">partition_specs</span><span class="p">,</span>
            <span class="n">serve_config</span><span class="o">=</span><span class="n">serve_config</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">shard_parameters</span><span class="p">:</span>
            <span class="n">params</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">shard_parameters</span><span class="p">(</span>
                <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
                <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
                <span class="n">serve_config</span><span class="o">=</span><span class="n">serve_config</span><span class="p">,</span>
                <span class="n">mesh</span><span class="o">=</span><span class="n">llm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">jax_mesh</span><span class="p">()</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
            <span class="n">serve_config</span><span class="o">=</span><span class="n">serve_config</span><span class="p">,</span>
            <span class="n">tokenizer</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">,</span>
            <span class="n">prefix_tokenizer</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">prefix_tokenizer</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">greedy_generate_function</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">greedy_generate_function</span><span class="p">,</span>
            <span class="n">non_greedy_generate_function</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">non_greedy_generate_function</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="o">*</span><span class="p">,</span>
            <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">max_new_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The process function is the main function of a model. It takes in an input string and returns a list of strings</span>
<span class="sd">        that are generated from that input string. The process function can be called multiple times with different inputs,</span>
<span class="sd">        and each time it will return a new set of outputs based on those inputs.</span>

<span class="sd">        :param self: Access the class attributes</span>
<span class="sd">        :param string: str: Pass the string that we want to generate</span>
<span class="sd">        :param greedy: bool: Determine whether to use the greedy or non-greedy version of the generate function</span>
<span class="sd">        :param max_new_tokens: int: Set the number of tokens to generate</span>
<span class="sd">        :param kwargs: Pass any additional parameters to the process function</span>
<span class="sd">        :return: A generator that yields the predicted text and the number of tokens generated</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">jax_mesh</span><span class="p">():</span>
            <span class="n">fixed_pad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_sequence_length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span>
            <span class="n">tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_tokenizer</span><span class="p">(</span>
                <span class="n">string</span><span class="p">,</span>
                <span class="n">max_length</span><span class="o">=</span><span class="n">fixed_pad</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span>
                <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;jax&quot;</span>
            <span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">use_prefix_tokenizer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span>
                <span class="n">string</span><span class="p">,</span>
                <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;jax&quot;</span>
            <span class="p">)</span>

            <span class="n">input_ids</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">input_ids</span>
            <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">attention_mask</span>
            <span class="n">num_generated_tokens</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">max_new_tokens</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_new_tokens</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">):</span>

                <span class="n">predicted_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_generation_function</span><span class="p">(</span><span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">)(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                    <span class="n">input_ids</span><span class="p">,</span>
                    <span class="n">attention_mask</span>
                <span class="p">)</span>

                <span class="n">num_generated_tokens</span> <span class="o">+=</span> <span class="n">predicted_token</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">plus_attn_mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
                    <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">),</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;i4&quot;</span>
                <span class="p">)</span>

                <span class="n">input_ids</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">predicted_token</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;i4&quot;</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
                <span class="p">)[:,</span> <span class="o">-</span><span class="n">fixed_pad</span><span class="p">:]</span>

                <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">plus_attn_mask</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;i4&quot;</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
                <span class="p">)[:,</span> <span class="o">-</span><span class="n">fixed_pad</span><span class="p">:]</span>

                <span class="n">returns</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="n">num_generated_tokens</span><span class="p">:],</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                    <span class="n">num_generated_tokens</span>
                <span class="p">)</span>

                <span class="k">yield</span> <span class="n">returns</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">use_mxn_break_point</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span> <span class="o">!=</span> <span class="n">predicted_token</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="p">(</span>
                        <span class="n">predicted_token</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">)</span>
                        <span class="ow">or</span>
                        <span class="n">predicted_token</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">break</span>

    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The compile function is used to compile the model for use in inference.</span>
<span class="sd">        It does this by running through all possible combinations of rules and actions,</span>
<span class="sd">        and compiling them into functions that can be called later on during inference.</span>
<span class="sd">        This allows us to avoid having to recompile the model every time we want to run it,</span>
<span class="sd">        which would be very slow.</span>

<span class="sd">        :param self: Represent the instance of the class</span>
<span class="sd">        :param verbose: bool: Print out the compiling process</span>
<span class="sd">        :return: True, but what does it do?</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">use_prefix_tokenizer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compiling greedy generate function&quot;</span><span class="p">)</span>
            <span class="n">response</span><span class="p">,</span> <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
            <span class="k">for</span> <span class="n">response</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                    <span class="n">string</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">max_new_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>
                    <span class="n">greedy</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">):</span>
                <span class="o">...</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compiling non-greedy generate function&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">response</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                    <span class="n">string</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="n">max_new_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>
                    <span class="n">greedy</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">):</span>
                <span class="o">...</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Skip Compiling the compiling process is useless &quot;</span>
                <span class="s2">&quot;when you are not using prefix tokenizer&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The __repr__ function is used to generate a string representation of an object.</span>
<span class="sd">        This function should return a string that can be parsed by the Python interpreter</span>
<span class="sd">        to recreate the object. The __repr__ function is called when you use print() on an</span>
<span class="sd">        object, or when you type its name in the REPL.</span>

<span class="sd">        :param self: Refer to the instance of the class</span>
<span class="sd">        :return: A string representation of the object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">repr_src</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> : &quot;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="n">string</span> <span class="o">+=</span> <span class="n">repr_src</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">repr_src</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> : &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(...)&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="o">...</span>
        <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The __str__ function is called when you use the print function or when str() is used.</span>
<span class="sd">        It should return a string representation of the object.</span>

<span class="sd">        :param self: Refer to the instance of the class</span>
<span class="sd">        :return: The object&#39;s string representation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">fire</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">uvicorn</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fast_api</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.__repr__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The <strong>repr</strong> function is used to generate a string representation of an object.
This function should return a string that can be parsed by the Python interpreter
to recreate the object. The <strong>repr</strong> function is called when you use print() on an
object, or when you type its name in the REPL.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Refer to the instance of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A string representation of the object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The __repr__ function is used to generate a string representation of an object.</span>
<span class="sd">    This function should return a string that can be parsed by the Python interpreter</span>
<span class="sd">    to recreate the object. The __repr__ function is called when you use print() on an</span>
<span class="sd">    object, or when you type its name in the REPL.</span>

<span class="sd">    :param self: Refer to the instance of the class</span>
<span class="sd">    :return: A string representation of the object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">string</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">repr_src</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> : &quot;</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">string</span> <span class="o">+=</span> <span class="n">repr_src</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">repr_src</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">500</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> : &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(...)&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="o">...</span>
    <span class="k">return</span> <span class="n">string</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.__str__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The <strong>str</strong> function is called when you use the print function or when str() is used.
It should return a string representation of the object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Refer to the instance of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The object's string representation</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The __str__ function is called when you use the print function or when str() is used.</span>
<span class="sd">    It should return a string representation of the object.</span>

<span class="sd">    :param self: Refer to the instance of the class</span>
<span class="sd">    :return: The object&#39;s string representation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.api_generate_request" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">api_generate_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The api_generate_request function is the main function that will be called by the API.
It takes in a GenerateAPIRequest object, which contains all the information needed to generate a response.
The request object has two fields: conversation and max_new_tokens. The conversation field is an array of strings,
which are each one turn in a conversation (i.e., one person's utterance). The max_new_tokens field specifies
 how many tokens can be generated at most for this response.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Access the attributes and methods of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>request</code></td>
          <td>
                <code><span title="lib.python.EasyDel.serve.serve_engine.dantics.GenerateAPIRequest">GenerateAPIRequest</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>GenerateAPIRequest: Pass the request object to the api_generate_request function</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary with the following keys {"response", "num_token_generated", "greedy", "model_prompt"}</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">api_generate_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">GenerateAPIRequest</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The api_generate_request function is the main function that will be called by the API.</span>
<span class="sd">    It takes in a GenerateAPIRequest object, which contains all the information needed to generate a response.</span>
<span class="sd">    The request object has two fields: conversation and max_new_tokens. The conversation field is an array of strings,</span>
<span class="sd">    which are each one turn in a conversation (i.e., one person&#39;s utterance). The max_new_tokens field specifies</span>
<span class="sd">     how many tokens can be generated at most for this response.</span>

<span class="sd">    :param self: Access the attributes and methods of the class</span>
<span class="sd">    :param request: GenerateAPIRequest: Pass the request object to the api_generate_request function</span>
<span class="sd">    :return: A dictionary with the following keys {&quot;response&quot;, &quot;num_token_generated&quot;, &quot;greedy&quot;, &quot;model_prompt&quot;}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conversation_template</span><span class="p">(</span>
        <span class="n">request</span><span class="o">.</span><span class="n">conversation</span>
    <span class="p">)</span>
    <span class="n">response</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">num_token_generated</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">response</span><span class="p">,</span> <span class="n">num_token_generated</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="n">string</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span>
            <span class="n">max_new_tokens</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">max_new_tokens</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_new_tokens</span><span class="p">,</span>
            <span class="n">greedy</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">greedy</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">greedy</span>
    <span class="p">):</span>
        <span class="o">...</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;response&quot;</span><span class="p">:</span> <span class="n">response</span><span class="p">,</span>
        <span class="s2">&quot;num_token_generated&quot;</span><span class="p">:</span> <span class="n">num_token_generated</span><span class="p">,</span>
        <span class="s2">&quot;greedy&quot;</span><span class="p">:</span> <span class="n">request</span><span class="o">.</span><span class="n">greedy</span><span class="p">,</span>
        <span class="s2">&quot;model_prompt&quot;</span><span class="p">:</span> <span class="n">prompt</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.compile" class="doc doc-heading">
          <code class="highlight language-python"><span class="nb">compile</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The compile function is used to compile the model for use in inference.
It does this by running through all possible combinations of rules and actions,
and compiling them into functions that can be called later on during inference.
This allows us to avoid having to recompile the model every time we want to run it,
which would be very slow.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Represent the instance of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>bool: Print out the compiling process</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True, but what does it do?</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The compile function is used to compile the model for use in inference.</span>
<span class="sd">    It does this by running through all possible combinations of rules and actions,</span>
<span class="sd">    and compiling them into functions that can be called later on during inference.</span>
<span class="sd">    This allows us to avoid having to recompile the model every time we want to run it,</span>
<span class="sd">    which would be very slow.</span>

<span class="sd">    :param self: Represent the instance of the class</span>
<span class="sd">    :param verbose: bool: Print out the compiling process</span>
<span class="sd">    :return: True, but what does it do?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">use_prefix_tokenizer</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compiling greedy generate function&quot;</span><span class="p">)</span>
        <span class="n">response</span><span class="p">,</span> <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">response</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">string</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">max_new_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>
                <span class="n">greedy</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">):</span>
            <span class="o">...</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Compiling non-greedy generate function&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">response</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
                <span class="n">string</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">max_new_tokens</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>
                <span class="n">greedy</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">):</span>
            <span class="o">...</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Skip Compiling the compiling process is useless &quot;</span>
            <span class="s2">&quot;when you are not using prefix tokenizer&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.conversation_template" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">conversation_template</span><span class="p">(</span><span class="n">conversation</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <pre><code>    The conversation_template function takes a list of ConversationItem objects and returns a string.
    The string is formatted as follows:
        &amp;lt;s&amp;gt;[INST] &amp;lt;&amp;lt;SYS&amp;gt;&amp;gt;{system_message}&amp;lt;&amp;lt;/SYS&amp;gt;&amp;gt;
</code></pre>
<p>{user_message} [/INST]
            {assistant_message} &lt;/s&gt;&lt;s&gt;[INST] ...
        where system message, user message, and assistant message are the content fields of the ConversationItem objects.
        If there is no system message in the conversation, then it will be omitted from the template.</p>
<pre><code>    :param self: Refer to the current instance of a class
    :param conversation: List[ConversationItem]: Pass in the conversation items
    :return: A string that is a concatenation of the messages in the conversation
</code></pre>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">conversation_template</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">conversation</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ConversationItem</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The conversation_template function takes a list of ConversationItem objects and returns a string.</span>
<span class="sd">    The string is formatted as follows:</span>
<span class="sd">        &amp;lt;s&amp;gt;[INST] &amp;lt;&amp;lt;SYS&amp;gt;&amp;gt;{system_message}&amp;lt;&amp;lt;/SYS&amp;gt;&amp;gt;\n\n{user_message} [/INST]</span>
<span class="sd">        {assistant_message} &amp;lt;/s&amp;gt;&amp;lt;s&amp;gt;[INST] ...</span>
<span class="sd">    where system message, user message, and assistant message are the content fields of the ConversationItem objects.</span>
<span class="sd">    If there is no system message in the conversation, then it will be omitted from the template.</span>

<span class="sd">    :param self: Refer to the current instance of a class</span>
<span class="sd">    :param conversation: List[ConversationItem]: Pass in the conversation items</span>
<span class="sd">    :return: A string that is a concatenation of the messages in the conversation</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">system</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">do_strip</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">conversation</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">conv</span><span class="o">.</span><span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;system&quot;</span><span class="p">:</span>
            <span class="n">system</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">content</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;&lt;s&gt;[INST] &lt;&lt;SYS&gt;&gt;</span><span class="se">\n</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="se">\n</span><span class="s2">&lt;&lt;/SYS&gt;&gt;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">system</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;&lt;s&gt;[INST] &quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">conv</span> <span class="ow">in</span> <span class="n">conversation</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">do_strip</span> <span class="k">else</span> <span class="n">conv</span><span class="o">.</span><span class="n">content</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">conv</span><span class="o">.</span><span class="n">role</span>
        <span class="n">do_strip</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span> <span class="ow">or</span> <span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;assistant&quot;</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2"> [/INST] &quot;</span> <span class="k">if</span> <span class="n">role</span> <span class="o">==</span> <span class="s2">&quot;user&quot;</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2"> &lt;/s&gt;&lt;s&gt;[INST] &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.create_generation_functions_and_tokenizers" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_generation_functions_and_tokenizers</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">serve_config</span><span class="p">,</span> <span class="n">partition_specs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The create_generation_functions_and_tokenizers function is used to create the functions that will be used for
generation. It also creates a tokenizer object that can be used to encode and decode text. The function takes in
a model, a tokenizer, an EasyServeConfig object (which contains all the parameters needed for generation), and
partition_specs which are specifications about how data should be partitioned across devices.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="lib.python.EasyDel.modules.easydel_modelling_utils.EasyDelFlaxPretrainedModel" href="../generated-modules-easydel_modelling_utils/#lib.python.EasyDel.modules.easydel_modelling_utils.EasyDelFlaxPretrainedModel">EasyDelFlaxPretrainedModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>EasyDelFlaxPretrainedModel: Create the model and tokenizer</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tokenizer</code></td>
          <td>
                <code><span title="transformers.PreTrainedTokenizerBase">PreTrainedTokenizerBase</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreTrainedTokenizerBase: Create a tokenizer object</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>serve_config</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="lib.python.EasyDel.serve.serve_engine.configuration.EasyServeConfig" href="../generated-serve-serve_engine-configuration/#lib.python.EasyDel.serve.serve_engine.configuration.EasyServeConfig">EasyServeConfig</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>EasyServeConfig: Create the generation function</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>partition_specs</code></td>
          <td>
                <code>dict[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dict[str, PartitionSpec]: Specify the sharding of the model parameters</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="lib.python.EasyDel.serve.serve_engine.serve.LLMBaseReq">LLMBaseReq</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An LLMBaseReq object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_generation_functions_and_tokenizers</span><span class="p">(</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">EasyDelFlaxPretrainedModel</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizerBase</span><span class="p">,</span>
        <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
        <span class="n">partition_specs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LLMBaseReq</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The create_generation_functions_and_tokenizers function is used to create the functions that will be used for</span>
<span class="sd">    generation. It also creates a tokenizer object that can be used to encode and decode text. The function takes in</span>
<span class="sd">    a model, a tokenizer, an EasyServeConfig object (which contains all the parameters needed for generation), and</span>
<span class="sd">    partition_specs which are specifications about how data should be partitioned across devices.</span>

<span class="sd">    :param model: EasyDelFlaxPretrainedModel: Create the model and tokenizer</span>
<span class="sd">    :param tokenizer: PreTrainedTokenizerBase: Create a tokenizer object</span>
<span class="sd">    :param serve_config: EasyServeConfig: Create the generation function</span>
<span class="sd">    :param partition_specs: dict[str, PartitionSpec]: Specify the sharding of the model parameters</span>
<span class="sd">    :return: An LLMBaseReq object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Tokenizer does not contain padding token setting padding token to eos token for open end generation&quot;</span><span class="p">)</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
        <span class="n">prefix_tokenizer</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
        <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
        <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The class Model of Tokenizer </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">tokenizer</span><span class="p">)</span><span class="si">}</span><span class="s2"> do not support deepcopy option &quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">use_prefix_tokenizer</span><span class="p">:</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;left&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">padding_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
            <span class="n">tokenizer</span><span class="o">.</span><span class="n">truncation_side</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span>
        <span class="n">prefix_tokenizer</span> <span class="o">=</span> <span class="n">tokenizer</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">pjit</span><span class="p">,</span>
        <span class="n">in_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">partition_specs</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">(),</span> <span class="n">PartitionSpec</span><span class="p">()),</span>
        <span class="n">out_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">PartitionSpec</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">greedy_generate_function</span><span class="p">(</span>
            <span class="n">parameters</span><span class="p">,</span>
            <span class="n">input_ids</span><span class="p">,</span>
            <span class="n">attention_mask</span>
    <span class="p">):</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
        <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
        <span class="n">predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
            <span class="n">input_ids</span><span class="p">,</span>
            <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">generation_config</span><span class="o">=</span><span class="n">GenerationConfig</span><span class="p">(</span>
                <span class="n">max_new_tokens</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>

                <span class="n">eos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">,</span>
                <span class="n">pad_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span><span class="p">,</span>
                <span class="n">bos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">bos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">,</span>

                <span class="n">do_sample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">num_beams</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sequences</span><span class="p">[:,</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>
        <span class="k">return</span> <span class="n">predict</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
        <span class="n">pjit</span><span class="p">,</span>
        <span class="n">in_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">partition_specs</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">(),</span> <span class="n">PartitionSpec</span><span class="p">()),</span>
        <span class="n">out_shardings</span><span class="o">=</span><span class="p">(</span><span class="n">PartitionSpec</span><span class="p">())</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">non_greedy_generate_function</span><span class="p">(</span>
            <span class="n">parameters</span><span class="p">,</span>
            <span class="n">input_ids</span><span class="p">,</span>
            <span class="n">attention_mask</span>
    <span class="p">):</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
        <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">with_sharding_constraint</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">serve_config</span><span class="o">.</span><span class="n">generation_ps</span><span class="p">)</span>
        <span class="n">predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
            <span class="n">input_ids</span><span class="p">,</span>
            <span class="n">attention_mask</span><span class="o">=</span><span class="n">attention_mask</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
            <span class="n">generation_config</span><span class="o">=</span><span class="n">GenerationConfig</span><span class="p">(</span>
                <span class="n">max_new_tokens</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">,</span>

                <span class="n">eos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">,</span>
                <span class="n">pad_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span><span class="p">,</span>
                <span class="n">bos_token_id</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">bos_token_id</span> <span class="ow">or</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">bos_token_id</span><span class="p">,</span>

                <span class="n">temperature</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span>
                <span class="n">repetition_penalty</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">repetition_penalty</span><span class="p">,</span>
                <span class="n">do_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">num_beams</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">top_p</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">top_p</span><span class="p">,</span>
                <span class="n">top_k</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">top_k</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sequences</span><span class="p">[:,</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>
        <span class="k">return</span> <span class="n">predict</span>

    <span class="k">return</span> <span class="n">LLMBaseReq</span><span class="p">(</span>
        <span class="n">greedy_generate_function</span><span class="o">=</span><span class="n">greedy_generate_function</span><span class="p">,</span>
        <span class="n">non_greedy_generate_function</span><span class="o">=</span><span class="n">non_greedy_generate_function</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
        <span class="n">prefix_tokenizer</span><span class="o">=</span><span class="n">prefix_tokenizer</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.create_shard_and_gather_functions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">create_shard_and_gather_functions</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">partition_rules</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;fp16&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The create_shard_and_gather_functions function takes in a dictionary of parameters,
a tuple of partition rules, and an optional dtype. It then matches the partition rules to the
parameters and creates shard functions for each parameter. The shard functions are used to
split up a parameter into shards (or partitions) that can be stored on different devices.
The gather function is used to combine all the shards back together again.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parameters</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dict: Specify the parameters of the model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>partition_rules</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple[Tuple[str,  PartitionSpec]]: Specify which parameters to partition</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="jax.numpy.dtype">dtype</span>, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>jax.numpy.dtype | str: Specify the data type of the parameters</p>
            </div>
          </td>
          <td>
                <code>&#39;fp16&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of three elements:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_shard_and_gather_functions</span><span class="p">(</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]],</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fp16&quot;</span>
<span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The create_shard_and_gather_functions function takes in a dictionary of parameters,</span>
<span class="sd">    a tuple of partition rules, and an optional dtype. It then matches the partition rules to the</span>
<span class="sd">    parameters and creates shard functions for each parameter. The shard functions are used to</span>
<span class="sd">    split up a parameter into shards (or partitions) that can be stored on different devices.</span>
<span class="sd">    The gather function is used to combine all the shards back together again.</span>

<span class="sd">    :param parameters: dict: Specify the parameters of the model</span>
<span class="sd">    :param partition_rules: Tuple[Tuple[str,  PartitionSpec]]: Specify which parameters to partition</span>
<span class="sd">    :param dtype: jax.numpy.dtype | str: Specify the data type of the parameters</span>
<span class="sd">    :return: A tuple of three elements:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">partition_specs</span> <span class="o">=</span> <span class="n">match_partition_rules</span><span class="p">(</span><span class="n">partition_rules</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
    <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">make_shard_and_gather_fns</span><span class="p">(</span>
        <span class="n">partition_specs</span><span class="o">=</span><span class="n">partition_specs</span><span class="p">,</span>
        <span class="n">dtype_specs</span><span class="o">=</span><span class="n">get_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span><span class="p">,</span> <span class="n">partition_specs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.from_parameters" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_parameters</span><span class="p">(</span><span class="n">llm</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">serve_config</span><span class="p">,</span> <span class="n">partition_rules</span><span class="p">,</span> <span class="n">shard_parameters</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The from_parameters function is the main entry point for creating a model that can be served.
It takes in a pretrained model, parameters, tokenizer and serve_config as input and returns an object of type
EasyServe.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cls</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Create a new instance of the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>llm</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="lib.python.EasyDel.modules.easydel_modelling_utils.EasyDelFlaxPretrainedModel" href="../generated-modules-easydel_modelling_utils/#lib.python.EasyDel.modules.easydel_modelling_utils.EasyDelFlaxPretrainedModel">EasyDelFlaxPretrainedModel</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>EasyDelFlaxPretrainedModel: Pass the model to the class</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>params</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>dict: Pass the parameters of the model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>tokenizer</code></td>
          <td>
                <code><span title="transformers.PreTrainedTokenizerBase">PreTrainedTokenizerBase</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>PreTrainedTokenizerBase: Create the tokenizer and prefix_tokenizer</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>serve_config</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="lib.python.EasyDel.serve.serve_engine.configuration.EasyServeConfig" href="../generated-serve-serve_engine-configuration/#lib.python.EasyDel.serve.serve_engine.configuration.EasyServeConfig">EasyServeConfig</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>EasyServeConfig: Configure the model for serving</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>partition_rules</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple[Tuple[str, PartitionSpec]]: Partition the parameters of the model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>shard_parameters</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>bool: Specify whether the parameters should be sharded or not</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Shard the parameters of the model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A EasyServe object</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_parameters</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">llm</span><span class="p">:</span> <span class="n">EasyDelFlaxPretrainedModel</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="p">:</span> <span class="n">PreTrainedTokenizerBase</span><span class="p">,</span>
        <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]],</span>
        <span class="n">shard_parameters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The from_parameters function is the main entry point for creating a model that can be served.</span>
<span class="sd">    It takes in a pretrained model, parameters, tokenizer and serve_config as input and returns an object of type</span>
<span class="sd">    EasyServe.</span>

<span class="sd">    :param cls: Create a new instance of the class</span>
<span class="sd">    :param llm: EasyDelFlaxPretrainedModel: Pass the model to the class</span>
<span class="sd">    :param params: dict: Pass the parameters of the model</span>
<span class="sd">    :param tokenizer: PreTrainedTokenizerBase: Create the tokenizer and prefix_tokenizer</span>
<span class="sd">    :param serve_config: EasyServeConfig: Configure the model for serving</span>
<span class="sd">    :param partition_rules: Tuple[Tuple[str, PartitionSpec]]: Partition the parameters of the model</span>
<span class="sd">    :param shard_parameters: bool: Specify whether the parameters should be sharded or not</span>
<span class="sd">    :param : Shard the parameters of the model</span>
<span class="sd">    :return: A EasyServe object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span><span class="p">,</span> <span class="n">partition_specs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_shard_and_gather_functions</span><span class="p">(</span>
        <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">serve_config</span><span class="o">.</span><span class="n">dtype</span>
    <span class="p">)</span>
    <span class="n">llm_base_req</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">create_generation_functions_and_tokenizers</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
        <span class="n">partition_specs</span><span class="o">=</span><span class="n">partition_specs</span><span class="p">,</span>
        <span class="n">serve_config</span><span class="o">=</span><span class="n">serve_config</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">shard_parameters</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">shard_parameters</span><span class="p">(</span>
            <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
            <span class="n">serve_config</span><span class="o">=</span><span class="n">serve_config</span><span class="p">,</span>
            <span class="n">mesh</span><span class="o">=</span><span class="n">llm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">jax_mesh</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">llm</span><span class="o">=</span><span class="n">llm</span><span class="p">,</span>
        <span class="n">serve_config</span><span class="o">=</span><span class="n">serve_config</span><span class="p">,</span>
        <span class="n">tokenizer</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">,</span>
        <span class="n">prefix_tokenizer</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">prefix_tokenizer</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
        <span class="n">greedy_generate_function</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">greedy_generate_function</span><span class="p">,</span>
        <span class="n">non_greedy_generate_function</span><span class="o">=</span><span class="n">llm_base_req</span><span class="o">.</span><span class="n">non_greedy_generate_function</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.sample" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sample</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">greedy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_new_tokens</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>The process function is the main function of a model. It takes in an input string and returns a list of strings
that are generated from that input string. The process function can be called multiple times with different inputs,
and each time it will return a new set of outputs based on those inputs.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>self</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Access the class attributes</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>string</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>str: Pass the string that we want to generate</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>greedy</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>bool: Determine whether to use the greedy or non-greedy version of the generate function</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>max_new_tokens</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>int: Set the number of tokens to generate</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Pass any additional parameters to the process function</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A generator that yields the predicted text and the number of tokens generated</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">greedy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">max_new_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The process function is the main function of a model. It takes in an input string and returns a list of strings</span>
<span class="sd">    that are generated from that input string. The process function can be called multiple times with different inputs,</span>
<span class="sd">    and each time it will return a new set of outputs based on those inputs.</span>

<span class="sd">    :param self: Access the class attributes</span>
<span class="sd">    :param string: str: Pass the string that we want to generate</span>
<span class="sd">    :param greedy: bool: Determine whether to use the greedy or non-greedy version of the generate function</span>
<span class="sd">    :param max_new_tokens: int: Set the number of tokens to generate</span>
<span class="sd">    :param kwargs: Pass any additional parameters to the process function</span>
<span class="sd">    :return: A generator that yields the predicted text and the number of tokens generated</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">jax_mesh</span><span class="p">():</span>
        <span class="n">fixed_pad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_sequence_length</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_tokenizer</span><span class="p">(</span>
            <span class="n">string</span><span class="p">,</span>
            <span class="n">max_length</span><span class="o">=</span><span class="n">fixed_pad</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;max_length&quot;</span><span class="p">,</span>
            <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;jax&quot;</span>
        <span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">use_prefix_tokenizer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="p">(</span>
            <span class="n">string</span><span class="p">,</span>
            <span class="n">return_tensors</span><span class="o">=</span><span class="s2">&quot;jax&quot;</span>
        <span class="p">)</span>

        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">input_ids</span>
        <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="n">attention_mask</span>
        <span class="n">num_generated_tokens</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                <span class="p">(</span><span class="n">max_new_tokens</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_new_tokens</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">):</span>

            <span class="n">predicted_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_generation_function</span><span class="p">(</span><span class="n">greedy</span><span class="o">=</span><span class="n">greedy</span><span class="p">)(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
                <span class="n">input_ids</span><span class="p">,</span>
                <span class="n">attention_mask</span>
            <span class="p">)</span>

            <span class="n">num_generated_tokens</span> <span class="o">+=</span> <span class="n">predicted_token</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">plus_attn_mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span><span class="p">),</span>
                <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;i4&quot;</span>
            <span class="p">)</span>

            <span class="n">input_ids</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">predicted_token</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;i4&quot;</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
            <span class="p">)[:,</span> <span class="o">-</span><span class="n">fixed_pad</span><span class="p">:]</span>

            <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">plus_attn_mask</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;i4&quot;</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
            <span class="p">)[:,</span> <span class="o">-</span><span class="n">fixed_pad</span><span class="p">:]</span>

            <span class="n">returns</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">input_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="n">num_generated_tokens</span><span class="p">:],</span> <span class="n">skip_special_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">num_generated_tokens</span>
            <span class="p">)</span>

            <span class="k">yield</span> <span class="n">returns</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">use_mxn_break_point</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">max_compile_tokens</span> <span class="o">!=</span> <span class="n">predicted_token</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="p">(</span>
                    <span class="n">predicted_token</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">)</span>
                    <span class="ow">or</span>
                    <span class="n">predicted_token</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serve_config</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">prefix_tokenizer</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="k">break</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="lib.python.EasyDel.serve.serve_engine.serve.EasyServe.shard_parameters" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">shard_parameters</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">partition_rules</span><span class="p">,</span> <span class="n">serve_config</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The shard_parameters function takes a set of parameters and partitions them according to the partition_rules.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>mesh</code></td>
          <td>
                <code><span title="jax.sharding.Mesh">Mesh</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Mesh: Create a mesh object that is used to shard the parameters</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>params</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="flax.core.FrozenDict">FrozenDict</span>, dict]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>FrozenDict | dict: Pass in the parameters of the model</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>partition_rules</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple[Tuple[str, PartitionSpec]]: Specify the partitioning rules for each parameter</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>serve_config</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="lib.python.EasyDel.serve.serve_engine.configuration.EasyServeConfig" href="../generated-serve-serve_engine-configuration/#lib.python.EasyDel.serve.serve_engine.configuration.EasyServeConfig">EasyServeConfig</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>EasyServeConfig: Specify the dtype of the parameters</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code></code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Create a mesh of devices</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>sharded parameters</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>lib/python/EasyDel/serve/serve_engine/serve.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">shard_parameters</span><span class="p">(</span>
        <span class="n">mesh</span><span class="p">:</span> <span class="n">Mesh</span><span class="p">,</span>
        <span class="n">params</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">FrozenDict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
        <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]],</span>
        <span class="n">serve_config</span><span class="p">:</span> <span class="n">EasyServeConfig</span><span class="p">,</span>
<span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The shard_parameters function takes a set of parameters and partitions them according to the partition_rules.</span>

<span class="sd">    :param mesh: Mesh: Create a mesh object that is used to shard the parameters</span>
<span class="sd">    :param params: FrozenDict | dict: Pass in the parameters of the model</span>
<span class="sd">    :param partition_rules: Tuple[Tuple[str, PartitionSpec]]: Specify the partitioning rules for each parameter</span>
<span class="sd">    :param serve_config: EasyServeConfig: Specify the dtype of the parameters</span>
<span class="sd">    :param : Create a mesh of devices</span>
<span class="sd">    :return: sharded parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">partition_specs</span> <span class="o">=</span> <span class="n">match_partition_rules</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">)</span>
    <span class="n">shard_fns</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">make_shard_and_gather_fns</span><span class="p">(</span><span class="n">partition_specs</span><span class="p">,</span> <span class="n">get_dtype</span><span class="p">(</span><span class="n">serve_config</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="k">with</span> <span class="n">mesh</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">func</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">param</span><span class="p">),</span> <span class="n">shard_fns</span><span class="p">,</span> <span class="n">params</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Erfan Zare Chavoshi-EasyDel
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
    
  </body>
</html>